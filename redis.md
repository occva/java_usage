## 什么是缓存击穿、缓存穿透、缓存雪崩?

### 缓存穿透

缓存穿透是指查询不存在的数据，由于缓存没有命中（因为数据根本就不存在），请求每次都会穿过缓存去查询数据库。如果这种查询非常频繁，就会给数据库造成很大的压力。

解决方法：

①、**缓存空值/默认值**
如果数据库查询结果为空，将该空结果（如 null 或 {}）缓存起来，并设置一个合理的过期时间。当后续请求再访问相同 ID 时，缓存直接返回空结果，避免每次都打到数据库。

②、**布隆过滤器**

通过布隆过滤器存储所有可能存在的合法数据的键，当请求到达时，先通过布隆过滤器判断该键是否存在：

- 如果布隆过滤器认为该键不存在，直接返回空，不会查询数据库。
- 如果布隆过滤器认为该键可能存在，则查询缓存和数据库。

### 缓存击穿

缓存击穿是指某一个高频数据在某个时间过期，大量请求就会直接到达数据库，导致数据库瞬间压力过大。

①、加互斥锁更新，⽐如请求查询 A，发现缓存中没有，对 A 这个 key 加锁，同时去数据库查询数据，写⼊缓存，再返回给⽤户，这样后⾯的请求就可以从缓存中拿到数据了。

②、设置热点数据永远不过期。

③、将过期时间组合写在 value 中，通过异步的⽅式不断的刷新过期时间，防⽌此类现象。

### 缓存雪崩

缓存雪崩是指在某一个时间点大量的缓存数据同时过期或缓存服务器突然宕机了，导致所有的请求都落到了数据库上，从而对数据库造成巨大压力，甚至导致数据库崩溃的现象。

- 给不同的Key的TTL添加随机值
- 利用Redis集群提高服务的可用性
- 给缓存业务添加降级限流策略
- 给业务添加多级缓存

## mysql的数据如何与redis进行同步呢？（双写一致性）

 延时双删

 分布式锁

 异步通知保证数据最终一致

 基于Canal的异步通知

![image-20250319164822646](https://s2.loli.net/2025/03/19/KIJaxndPU8L9Qcj.png)

## 你听说过延时双删吗？为什么不用它呢？

延迟双删，如果是写操作，我们先把缓存中的数据删除，然后更新数据库，最后再延时删除缓存中的数据。其中，这个延时多久不太好确定。在延时的过程中，可能会出现脏数据，并不能保证强一致性，所以没有采用它。

## **redis做为缓存，数据的持久化是怎么做的？**

Redis 的持久化机制保证了 Redis 服务器在重启后数据不丢失，通过 RDB 和 AOF 文件来恢复内存中原有的数据。这两种持久化方式可以单独使用，也可以同时使用。

#### [说一下 RDB？](https://javabetter.cn/sidebar/sanfene/redis.html#说一下-rdb)

RDB 持久化通过创建数据集的快照来工作，在指定的时间间隔内将 Redis 在某一时刻的数据状态保存到磁盘的一个 RDB 文件中。

![image-20250319165342718](https://s2.loli.net/2025/03/19/YPVhltKWmJa9gGr.png)

#### [说一下 AOF？](https://javabetter.cn/sidebar/sanfene/redis.html#说一下-aof)

AOF 持久化通过记录每个写操作命令并将其追加到 AOF 文件中来工作，恢复时通过重新执行这些命令来重建数据集。

![](https://s2.loli.net/2025/03/19/FTynC631qUYP4JA.png)





## **Redis的数据过期策略有哪些？**

Redis 的 key 过期回收策略主要有两种：惰性删除和定期删除。

![image-20250319170535458](https://s2.loli.net/2025/03/19/Bpt2yAgqaJnFDMr.png)



